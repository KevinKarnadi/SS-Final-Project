{"version":3,"sources":["assets\\scripts\\Win.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AACM,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAiC,uBAAY;IAA7C;QAAA,qEA8HC;QA3HG,gBAAU,GAAa,IAAI,CAAC;QAG5B,iBAAW,GAAY,IAAI,CAAC;QAG5B,iBAAW,GAAa,IAAI,CAAC;QAG7B,eAAS,GAAa,IAAI,CAAC;QAG3B,gBAAU,GAAa,IAAI,CAAC;QAG5B,iBAAW,GAAY,IAAI,CAAC;QAG5B,QAAE,GAAY,IAAI,CAAC;QAGnB,WAAK,GAAmB,IAAI,CAAC;QAG7B,WAAK,GAAmB,IAAI,CAAC;QAG7B,WAAK,GAAmB,IAAI,CAAC;QAG7B,WAAK,GAAmB,IAAI,CAAC;QAErB,cAAQ,GAAG,KAAK,CAAC;;IA2F7B,CAAC;IAzFG,wBAAwB;IAExB,eAAe;IAEf,mBAAK,GAAL;IAEA,CAAC;IAED,oBAAM,GAAN,UAAQ,EAAE;QACN,IAAG,CAAC,IAAI,CAAC,QAAQ,EAAC;YACd,IAAG,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,MAAM,EAAE,EAAC;gBACnE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBAErB,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,EAAE,CAAC,IAAI,CAAC,oCAAoC,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC;gBAC5H,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,EAAE,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC;gBAChG,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,EAAE,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC;gBAC9F,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,EAAE,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC;gBAC5F,IAAI,CAAC,cAAc,EAAE,CAAC;gBACtB,IAAG,EAAE,CAAC,IAAI,CAAC,qCAAqC,CAAC,CAAC,MAAM,EAAC;oBACrD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;oBAClE,gEAAgE;iBACnE;gBACD,IAAG,EAAE,CAAC,IAAI,CAAC,qCAAqC,CAAC,CAAC,MAAM,EAAC;oBACrD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;oBAClE,gEAAgE;iBACnE;gBACD,IAAG,EAAE,CAAC,IAAI,CAAC,qCAAqC,CAAC,CAAC,MAAM,EAAC;oBACrD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;oBAClE,gEAAgE;iBACnE;gBACD,IAAG,EAAE,CAAC,IAAI,CAAC,qCAAqC,CAAC,CAAC,MAAM,EAAC;oBACrD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;oBAClE,gEAAgE;iBACnE;gBACD,EAAE,CAAC,IAAI,CAAC,6BAA6B,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;gBACtD,EAAE,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;gBACvD,EAAE,CAAC,IAAI,CAAC,gCAAgC,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;gBACzD,EAAE,CAAC,IAAI,CAAC,+BAA+B,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;gBACxD,IAAI,MAAM,GAAG,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;gBACtD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;aAC/B;SACJ;aACI;YACD,IAAI,CAAC,YAAY,CAAC;gBACd,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;YACpC,CAAC,EAAE,CAAC,CAAC,CAAA;SACR;IACL,CAAC;IAED,4BAAc,GAAd;QACI,IAAI,OAAO,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QAC/C,IAAI,MAAM,GAAG,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAC7C,IAAI,QAAQ,GAAG,QAAQ,CAAC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;QAC7D,IAAI,OAAO,GAAG,QAAQ,CAAC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;QAC3D,IAAI,QAAQ,GAAG,QAAQ,GAAG,OAAO,CAAC;QAClC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;QAC9C,IAAI,OAAO,GAAG,OAAO,GAAG,MAAM,CAAC;QAC/B,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;QAC5C,IAAI,IAAI,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC,WAAW,CAAC;QACvC,IAAG,IAAI,EAAE;YACL,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACnB,IAAI,KAAK,GAAG,QAAQ,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;YAC5D,IAAI,SAAS,GAAG;gBACZ,IAAI,EAAE,QAAQ;gBACd,GAAG,EAAE,OAAO;aACf,CAAA;YACD,OAAO,QAAQ,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;SAC5E;IACL,CAAC;IAED,6BAAe,GAAf,UAAgB,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ;QAC/G,IAAI,SAAS,GAAG;YACZ,IAAI,EAAE,IAAI;YACV,GAAG,EAAE,GAAG;YACR,KAAK,EAAE,KAAK;YACZ,KAAK,EAAE,KAAK;YACZ,KAAK,EAAE,KAAK;YACZ,KAAK,EAAE,KAAK;YACZ,IAAI,EAAE,IAAI;YACV,EAAE,EAAE,EAAE;YACN,OAAO,EAAE,OAAO;YAChB,OAAO,EAAE,OAAO;YAChB,MAAM,EAAE,MAAM;YACd,MAAM,EAAE,MAAM;YACd,MAAM,EAAE,MAAM;YACd,QAAQ,EAAE,QAAQ;SACrB,CAAA;QACD,OAAO,QAAQ,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,WAAW,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IACpG,CAAC;IA1HD;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;2CACS;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;4CACU;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;4CACU;IAG7B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;0CACQ;IAG3B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;2CACS;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;4CACU;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;mCACC;IAGnB;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;sCACI;IAG7B;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;sCACI;IAG7B;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;sCACI;IAG7B;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;sCACI;IAjCZ,GAAG;QADvB,OAAO;OACa,GAAG,CA8HvB;IAAD,UAAC;CA9HD,AA8HC,CA9HgC,EAAE,CAAC,SAAS,GA8H5C;kBA9HoB,GAAG","file":"","sourceRoot":"/","sourcesContent":["declare const firebase: any;\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Win extends cc.Component {\r\n\r\n    @property(cc.Label)\r\n    playername: cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    playerimage: cc.Node = null;\r\n\r\n    @property(cc.Label)\r\n    winnerScore: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    winnerGem: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    winnerCoin: cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    GameManager: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    UI: cc.Node = null;\r\n\r\n    @property(cc.SpriteFrame)\r\n    char1: cc.SpriteFrame = null;\r\n\r\n    @property(cc.SpriteFrame)\r\n    char2: cc.SpriteFrame = null;\r\n\r\n    @property(cc.SpriteFrame)\r\n    char3: cc.SpriteFrame = null;\r\n\r\n    @property(cc.SpriteFrame)\r\n    char4: cc.SpriteFrame = null;\r\n\r\n    private gameover = false;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    start () {\r\n        \r\n    }\r\n\r\n    update (dt) {\r\n        if(!this.gameover){\r\n            if(cc.find(\"Canvas/Game Manager\").getComponent(\"GameManager\").getWin()){\r\n                this.gameover = true;\r\n\r\n                this.playername.getComponent(cc.Label).string = cc.find(\"Canvas/Main Camera/UI/Profile/name\").getComponent(cc.Label).string;\r\n                this.winnerScore.string = cc.find(\"Canvas/Main Camera/UI\").getComponent(\"UI\").scoreLabel.string;\r\n                this.winnerCoin.string = cc.find(\"Canvas/Main Camera/UI\").getComponent(\"UI\").coinLabel.string;\r\n                this.winnerGem.string = cc.find(\"Canvas/Main Camera/UI\").getComponent(\"UI\").gemLabel.string;\r\n                this.updateDatabase();\r\n                if(cc.find(\"Canvas/Main Camera/UI/Profile/face0\").active){\r\n                    this.playerimage.getComponent(cc.Sprite).spriteFrame = this.char1;\r\n                    //cc.find(\"Canvas/Main Camera/UI/Profile/face0\").active = false;\r\n                }\r\n                if(cc.find(\"Canvas/Main Camera/UI/Profile/face1\").active){\r\n                    this.playerimage.getComponent(cc.Sprite).spriteFrame = this.char2;\r\n                    //cc.find(\"Canvas/Main Camera/UI/Profile/face1\").active = false;\r\n                }\r\n                if(cc.find(\"Canvas/Main Camera/UI/Profile/face2\").active){\r\n                    this.playerimage.getComponent(cc.Sprite).spriteFrame = this.char3;\r\n                    //cc.find(\"Canvas/Main Camera/UI/Profile/face2\").active = false;\r\n                }\r\n                if(cc.find(\"Canvas/Main Camera/UI/Profile/face3\").active){\r\n                    this.playerimage.getComponent(cc.Sprite).spriteFrame = this.char4;\r\n                    //cc.find(\"Canvas/Main Camera/UI/Profile/face3\").active = false;\r\n                }\r\n                cc.find(\"Canvas/Main Camera/UI/Timer\").active = false;\r\n                cc.find(\"Canvas/Main Camera/UI/Record\").active = false;\r\n                cc.find(\"Canvas/Main Camera/UI/WeaponUi\").active = false;\r\n                cc.find(\"Canvas/Main Camera/UI/Profile\").active = false;\r\n                let action = cc.sequence(cc.fadeIn(2), cc.fadeOut(2));\r\n                this.node.runAction(action);\r\n            }\r\n        }\r\n        else {\r\n            this.scheduleOnce(()=>{\r\n                cc.director.loadScene(\"ending\");\r\n            }, 6)\r\n        }\r\n    }\r\n\r\n    updateDatabase() {\r\n        let winCoin = parseInt(this.winnerCoin.string);\r\n        let winGem = parseInt(this.winnerGem.string);\r\n        let currCoin = parseInt(cc.sys.localStorage.getItem(\"coin\"));\r\n        let currGem = parseInt(cc.sys.localStorage.getItem(\"gem\"));\r\n        let lastCoin = currCoin + winCoin;\r\n        cc.sys.localStorage.setItem(\"coin\", lastCoin);\r\n        let lastGem = currGem + winGem;\r\n        cc.sys.localStorage.setItem(\"gem\", lastGem);\r\n        let user = firebase.auth().currentUser;\r\n        if(user) {\r\n            console.log(\"aaa\");\r\n            var stats = firebase.database().ref(\"userData/\" + user.uid);\r\n            var userStats = {\r\n                coin: lastCoin,\r\n                gem: lastGem\r\n            }\r\n            return firebase.database().ref(\"userData/\" + user.uid).update(userStats);\r\n        }\r\n    }\r\n\r\n    updateUserStats(coin, gem, char1, char2, char3, char4, AK47, AR, grenade, shotgun, sniper, purple, forest, username) {\r\n        var userStats = {\r\n            coin: coin,\r\n            gem: gem,\r\n            char1: char1,\r\n            char2: char2,\r\n            char3: char3,\r\n            char4: char4,\r\n            AK47: AK47,\r\n            AR: AR,\r\n            grenade: grenade,\r\n            shotgun: shotgun,\r\n            sniper: sniper,\r\n            purple: purple,\r\n            forest: forest,\r\n            username: username\r\n        }\r\n        return firebase.database().ref(\"userData/\" + firebase.auth().currentUser.uid).update(userStats);\r\n    }\r\n}\r\n"]}