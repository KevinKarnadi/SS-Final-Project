{"version":3,"sources":["assets\\scripts\\GameManager.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;AAClF,mCAA6B;AAC7B,2BAAqB;AAEf,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAsC,4BAAY;IAAlD;QAAA,qEA2PC;QAxPG,aAAO,GAAW,IAAI,CAAC;QAGvB,aAAO,GAAW,IAAI,CAAC;QAGvB,aAAO,GAAW,IAAI,CAAC;QAGvB,QAAE,GAAO,IAAI,CAAC;QAGd,YAAM,GAAY,IAAI,CAAC;QAGvB,SAAG,GAAiB,IAAI,CAAC;QAEjB,YAAM,GAAG,IAAI,CAAC;QAEd,cAAQ,GAAY,KAAK,CAAC;QAE1B,cAAQ,GAAY,KAAK,CAAC;QAE1B,WAAK,GAAY,KAAK,CAAC;QAIvB,iBAAW,GAAW,CAAC,CAAC;QAExB,gBAAU,GAAG,IAAI,CAAC;;IA2N9B,CAAC;IAzNG,gCAAgC;IAEhC,wBAAwB;IAExB,yBAAM,GAAN;QACI,EAAE,CAAC,QAAQ,CAAC,iBAAiB,EAAE,CAAC,OAAO,GAAG,IAAI,CAAC;QAC/C,EAAE,CAAC,QAAQ,CAAC,iBAAiB,EAAE,CAAC,OAAO,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QACzD,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QAC3E,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAC3E,CAAC;IAED,wBAAK,GAAL;QACI,iBAAiB;QACjB,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;IACzB,CAAC;IAED,yBAAM,GAAN,UAAQ,EAAE;QACN,IAAI,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;QAC/C,IAAI,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;QAC1C,SAAS,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,EAAE,SAAS,CAAC,CAAC;QAC1C,SAAS,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;QAClD,IAAG,SAAS,CAAC,CAAC,GAAG,CAAC,EAAE;YAChB,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC;SACnB;aAAM,IAAG,SAAS,CAAC,CAAC,GAAG,IAAI,EAAE;YAC1B,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC;SACtB;QACD,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;IACvC,CAAC;IAED,+BAAY,GAAZ,UAAa,GAAG;QACZ,IAAI,CAAC,UAAU,GAAG,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC;QACzC,IAAG,IAAI,CAAC,MAAM,EAAE;YACZ,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC;YACtC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACjC,IAAI,CAAC,SAAS,EAAE,CAAC;SACpB;QACD,QAAQ,IAAI,CAAC,UAAU,EAAE;YACrB,KAAK,CAAC;gBACF,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;gBAC3B,MAAM;YACV,KAAK,CAAC;gBACF,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;gBAC3B,MAAM;YACV,KAAK,CAAC;gBACF,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;gBAC3B,MAAM;YACV;gBACI,MAAM;SACb;QACD,IAAI,CAAC,QAAQ,EAAE,CAAC;IACpB,CAAC;IAED,0BAAO,GAAP;QACI,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;IAC7C,CAAC;IAES,2BAAQ,GAAlB;QACI,IAAG,IAAI,CAAC,MAAM,EAAE;YACZ,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC,CAAI,UAAU;YAC1F,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,CAAM,MAAM;YACtF,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC,CAAE,QAAQ;YACxF,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC,CAAM,eAAe;SAChG;IACL,CAAC;IAES,4BAAS,GAAnB;QACI,IAAG,IAAI,CAAC,MAAM,EAAE;YACZ,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC,CAAG,UAAU;YAC1F,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,CAAK,MAAM;YACtF,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC,QAAQ;YACxF,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC,CAAM,eAAe;SAChG;IACL,CAAC;IAED,4BAAS,GAAT,UAAU,CAAC;QACP,QAAQ,CAAC,CAAC,OAAO,EAAE;YACf,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAS,YAAY;gBACpC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,CAAC;gBACvC,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAS,aAAa;gBACrC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC;gBACtC,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,EAAK,OAAO;gBAC/B,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;gBAChC,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM;gBACpB,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC;gBAChB,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAS,OAAO;gBAC/B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;gBACvC,MAAM;YACV;gBACI,MAAM;SACb;IACL,CAAC;IAED,0BAAO,GAAP,UAAQ,CAAC;QACL,QAAQ,CAAC,CAAC,OAAO,EAAE;YACf,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACf,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;gBACtB,IAAG,IAAI,CAAC,QAAQ,EAAE;oBACd,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,CAAE,aAAa;iBACxD;qBAAM;oBACH,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,CAAE,cAAc;iBACzD;gBACD,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACf,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;gBACtB,IAAG,IAAI,CAAC,QAAQ,EAAE;oBACd,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;iBACvD;qBAAM;oBACH,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC,CAAE,cAAc;iBACzD;gBACD,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK;gBACnB,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBACjC,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAS,iBAAiB;gBACzC,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC;gBAC7B,MAAM;YACV,KAAK,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAS,OAAO;gBAC/B,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;gBAC9B,MAAM;YACV;gBACI,MAAM;SACb;IACL,CAAC;IAED,+BAAY,GAAZ,UAAc,KAAK;QACf,IAAI,CAAC,IAAI,CAAC,kBAAkB;YAAE,OAAO;QAErC,IAAG,CAAC,IAAI,CAAC,KAAK,EAAE;YACZ,sCAAsC;YACtC,mCAAmC;YACnC,4BAA4B;YAC5B,yCAAyC;YACzC,+BAA+B;SAClC;QACD,KAAK,CAAC,eAAe,EAAE,CAAC;IAC5B,CAAC;IAED,8BAAW,GAAX,UAAa,KAAK;QACd,IAAI,CAAC,IAAI,CAAC,kBAAkB;YAAE,OAAO;QAErC,IAAG,CAAC,IAAI,CAAC,KAAK,EAAC;YACX,+FAA+F;YAC/F,IAAI,SAAS,GAAG,KAAK,CAAC,gBAAgB,EAAE,CAAC;YACzC,IAAI,QAAQ,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;YACnC,IAAI,KAAK,GAAG,QAAQ,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;YACrC,IAAI,KAAK,GAAG,QAAQ,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;YACrC,qEAAqE;YACrE,6CAA6C;YAC7C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,GAAG,CAAC,GAAG,GAAE,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;YACtE,IAAG,IAAI,CAAC,UAAU,IAAI,CAAC,EAAE;gBACrB,IAAI,CAAC,MAAM,CAAC,wBAAwB,CAAC,CAAC,CAAC,CAAC,CAAC;aAC5C;iBAAM;gBACH,IAAI,CAAC,MAAM,CAAC,wBAAwB,CAAC,CAAC,CAAC,CAAC;aAC3C;YACD,sBAAsB;YACtB,+CAA+C;YAC/C,8CAA8C;YAE9C,QAAQ;YACR,4CAA4C;YAC5C,8CAA8C;YAC9C,8CAA8C;YAC9C,0BAA0B;YAC1B,qBAAqB;YAErB,aAAa;YACb,4BAA4B;YAC5B,2BAA2B;YAE3B,IAAI;YACJ,wCAAwC;YACxC,iCAAiC;YACjC,sBAAsB;YAEtB,mCAAmC;YACnC,oCAAoC;YACpC,qDAAqD;YACrD,IAAI;YAEJ,mDAAmD;YAEnD,yCAAyC;YACzC,+BAA+B;SAClC;QAED,KAAK,CAAC,eAAe,EAAE,CAAC;IAC5B,CAAC;IAED,gCAAa,GAAb,UAAe,KAAK;QAChB,IAAI,CAAC,IAAI,CAAC,kBAAkB;YAAE,OAAO;QAErC,IAAI,CAAC,QAAQ,EAAE,CAAC;QAEhB,KAAK,CAAC,eAAe,EAAE,CAAC;IAC5B,CAAC;IAED,6BAAU,GAAV,UAAY,KAAK;QACb,IAAI,CAAC,IAAI,CAAC,kBAAkB;YAAE,OAAO;QAErC,IAAI,CAAC,QAAQ,EAAE,CAAC;QAEhB,KAAK,CAAC,eAAe,EAAE,CAAC;IAC5B,CAAC;IAED,2BAAQ,GAAR;QACI,IAAG,IAAI,CAAC,KAAK;YAAE,OAAO;QAEtB,qBAAqB;QACrB,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC3C,IAAI,CAAC,MAAM,CAAC,wBAAwB,CAAC,CAAC,CAAC,CAAC;IAC5C,CAAC;IAvPD;QADC,QAAQ,CAAC,gBAAM,CAAC;6CACM;IAGvB;QADC,QAAQ,CAAC,gBAAM,CAAC;6CACM;IAGvB;QADC,QAAQ,CAAC,gBAAM,CAAC;6CACM;IAGvB;QADC,QAAQ,CAAC,YAAE,CAAC;wCACC;IAGd;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;4CACK;IAGvB;QADC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC;yCACE;IAlBR,QAAQ;QAD5B,OAAO;OACa,QAAQ,CA2P5B;IAAD,eAAC;CA3PD,AA2PC,CA3PqC,EAAE,CAAC,SAAS,GA2PjD;kBA3PoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\nimport Player from \"./Player\"\r\nimport UI from \"./UI\"\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    @property(Player)\r\n    player1: Player = null;\r\n\r\n    @property(Player)\r\n    player2: Player = null;\r\n\r\n    @property(Player)\r\n    player3: Player = null;\r\n\r\n    @property(UI)\r\n    UI: UI = null;\r\n\r\n    @property(cc.Node)\r\n    camera: cc.Node = null;\r\n\r\n    @property(cc.AudioClip)\r\n    bgm: cc.AudioClip = null;\r\n\r\n    private player = null;\r\n\r\n    private aKeyDown: boolean = false;\r\n\r\n    private dKeyDown: boolean = false;\r\n\r\n    private shoot: boolean = false;\r\n\r\n    private currPlayer: number;\r\n\r\n    private totalPlayer: number = 3;\r\n\r\n    private shootAngle = null;\r\n\r\n    // private currPlayerPos = null;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        cc.director.getPhysicsManager().enabled = true;\r\n        cc.director.getPhysicsManager().gravity = cc.v2(0, -980);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n    \r\n    start () {\r\n        //this.playBGM();\r\n        this.changePlayer(0);\r\n    }\r\n\r\n    update (dt) {\r\n        var playerPos = this.player.node.getPosition();\r\n        var cameraPos = this.camera.getPosition();\r\n        cameraPos.lerp(playerPos, 0.1, cameraPos);\r\n        cameraPos.y = cc.misc.clampf(playerPos.y, 0, 200);\r\n        if(cameraPos.x < 0) {\r\n            cameraPos.x = 0;\r\n        } else if(cameraPos.x > 8500) {\r\n            cameraPos.x = 8500;\r\n        }\r\n        this.camera.setPosition(cameraPos);\r\n    }\r\n\r\n    changePlayer(num) {\r\n        this.currPlayer = num % this.totalPlayer;\r\n        if(this.player) {\r\n            this.player.setPlayerMoveDirection(0);\r\n            this.player.setPlayerJump(false);\r\n            this.onDisable();\r\n        } \r\n        switch (this.currPlayer) {\r\n            case 0:\r\n                this.player = this.player1;\r\n                break;\r\n            case 1:\r\n                this.player = this.player2;\r\n                break;\r\n            case 2:\r\n                this.player = this.player3;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.onEnable();\r\n    }\r\n\r\n    playBGM() {\r\n        cc.audioEngine.playMusic(this.bgm, true);\r\n    }\r\n\r\n    protected onEnable(): void {\r\n        if(this.player) {\r\n            this.player.node.on(cc.Node.EventType.TOUCH_START, this.onEventStart, this);    // touched\r\n            this.player.node.on(cc.Node.EventType.TOUCH_MOVE, this.onEventMove, this);      // aim\r\n            this.player.node.on(cc.Node.EventType.TOUCH_CANCEL, this.onEventCancel, this);  // shoot\r\n            this.player.node.on(cc.Node.EventType.TOUCH_END, this.onEventEnd, this);      // cancel shoot\r\n        }\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        if(this.player) {\r\n            this.player.node.off(cc.Node.EventType.TOUCH_START, this.onEventStart, this);   // touched\r\n            this.player.node.off(cc.Node.EventType.TOUCH_MOVE, this.onEventMove, this);     // aim\r\n            this.player.node.off(cc.Node.EventType.TOUCH_CANCEL, this.onEventCancel, this); // shoot\r\n            this.player.node.on(cc.Node.EventType.TOUCH_END, this.onEventEnd, this);      // cancel shoot\r\n        }\r\n    }\r\n\r\n    onKeyDown(e) {\r\n        switch (e.keyCode) {\r\n            case cc.macro.KEY.a:        // move left\r\n                this.aKeyDown = true;\r\n                this.player.setPlayerMoveDirection(-1);\r\n                break;\r\n            case cc.macro.KEY.d:        // move right\r\n                this.dKeyDown = true;\r\n                this.player.setPlayerMoveDirection(1);\r\n                break;\r\n            case cc.macro.KEY.space:    // jump\r\n                this.player.setPlayerJump(true);\r\n                break;\r\n            case cc.macro.KEY.escape:\r\n                this.UI.pause();\r\n                break;\r\n            case cc.macro.KEY.p:        // pass\r\n                this.changePlayer(this.currPlayer + 1);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    onKeyUp(e) {\r\n        switch (e.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.aKeyDown = false;\r\n                if(this.dKeyDown) {\r\n                    this.player.setPlayerMoveDirection(1);  // move right\r\n                } else {\r\n                    this.player.setPlayerMoveDirection(0);  // stop moving\r\n                }\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.dKeyDown = false;\r\n                if(this.aKeyDown) {\r\n                    this.player.setPlayerMoveDirection(-1); // move left\r\n                } else {\r\n                    this.player.setPlayerMoveDirection(0);  // stop moving\r\n                }\r\n                break;\r\n            case cc.macro.KEY.space:\r\n                this.player.setPlayerJump(false);\r\n                break;\r\n            case cc.macro.KEY.f:        // shoot (bullet)\r\n                this.player.setPlayerShoot();\r\n                break;\r\n            case cc.macro.KEY.r:        // bomb\r\n                this.player.setPlayerBomb(45);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    onEventStart (event) {  // touched\r\n        if (!this.enabledInHierarchy) return;\r\n\r\n        if(!this.shoot) {\r\n            // this.startPos = this.node.position;\r\n            // this.motorJoint.enabled = false;\r\n            // this.rb.gravityScale = 0;\r\n            // this.rb.linearVelocity = cc.Vec2.ZERO;\r\n            // this.rb.angularVelocity = 0;\r\n        }\r\n        event.stopPropagation();\r\n    }\r\n    \r\n    onEventMove (event) {   // aim\r\n        if (!this.enabledInHierarchy) return;\r\n    \r\n        if(!this.shoot){\r\n            // var playerPos = cc.v2(this.player.node.position.x + 480, this.player.node.position.y + 320);\r\n            var playerPos = event.getStartLocation();\r\n            var mousePos = event.getLocation();\r\n            var diffX = mousePos.x - playerPos.x;\r\n            var diffY = mousePos.y - playerPos.y;\r\n            // mousePos = this.player.node.parent.convertToNodeSpaceAR(mousePos);\r\n            // var angle = mousePos.signAngle(playerPos);\r\n            this.shootAngle = Math.atan2(diffX, diffY) * (180/ Math.PI) - 90 * -1;\r\n            if(this.shootAngle >= 0) {\r\n                this.player.setPlayerChangeDirection(-1);\r\n            } else {\r\n                this.player.setPlayerChangeDirection(1);\r\n            }\r\n            // console.log(angle);\r\n            // console.log(playerPos.x + \" \" + playerPos.y)\r\n            // console.log(mousePos.x + \" \" + mousePos.y);\r\n\r\n            // gagal\r\n            // var pos = this.player.node.getPosition();\r\n            // var angle = pos.angle(event.getLocation());\r\n            // var degr = cc.misc.radiansToDegrees(angle);\r\n            // this.player.node.getjoi\r\n            // console.log(angle)\r\n\r\n            // angry bird\r\n            // if(this.currAngle < 90) {\r\n            //     this.currAngle += 1;\r\n\r\n            // }\r\n            // let start = event.getStartLocation();\r\n            // let cur = event.getLocation();\r\n            // cur.subSelf(start);\r\n            \r\n            // let cur_v = cc.v2(cur.x, cur.y);\r\n            // if(cur_v.mag() > this.maxLength){\r\n            //     cur_v.normalizeSelf().mulSelf(this.maxLength);\r\n            // }\r\n\r\n            // this.node.setPosition(this.startPos.add(cur_v));\r\n            \r\n            // this.rb.linearVelocity = cc.Vec2.ZERO;\r\n            // this.rb.angularVelocity = 0;\r\n        }\r\n\r\n        event.stopPropagation();\r\n    }\r\n\r\n    onEventCancel (event) { // shoot\r\n        if (!this.enabledInHierarchy) return;\r\n\r\n        this.haveShot();\r\n    \r\n        event.stopPropagation();\r\n    }\r\n    \r\n    onEventEnd (event) {  // cancel shoot\r\n        if (!this.enabledInHierarchy) return;\r\n    \r\n        this.haveShot();\r\n    \r\n        event.stopPropagation();\r\n    }\r\n\r\n    haveShot() {\r\n        if(this.shoot) return;\r\n\r\n        // this.shoot = true;\r\n        this.player.setPlayerBomb(this.shootAngle);\r\n        this.player.setPlayerChangeDirection(0);\r\n    }\r\n}\r\n"]}