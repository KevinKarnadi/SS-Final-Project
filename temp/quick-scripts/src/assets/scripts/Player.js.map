{"version":3,"sources":["assets\\scripts\\Player.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAE5E,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAoC,0BAAY;IAAhD;QAAA,qEAoLC;QAjLG,eAAS,GAAiB,IAAI,CAAC;QAG/B,cAAQ,GAAiB,IAAI,CAAC;QAGtB,kBAAY,GAAc,IAAI,CAAC;QAG/B,gBAAU,GAAc,IAAI,CAAC;QAE7B,gBAAU,GAAG,IAAI,CAAC;QAElB,eAAS,GAAW,GAAG,CAAC;QAExB,mBAAa,GAAW,CAAC,CAAC;QAE1B,qBAAe,GAAW,CAAC,CAAC;QAE5B,kBAAY,GAAW,IAAI,CAAC;QAE5B,UAAI,GAAY,KAAK,CAAC;QAEtB,gBAAU,GAAY,KAAK,CAAC;QAE5B,WAAK,GAAY,KAAK,CAAC;QAEvB,YAAM,GAAY,KAAK,CAAC;QAExB,eAAS,GAAiB,IAAI,CAAC;QAE/B,oBAAc,GAAG,IAAI,CAAC;QAEtB,eAAS,GAAiB,IAAI,CAAC;QAE/B,gBAAU,GAAY,KAAK,CAAC;QAE5B,SAAG,GAAY,KAAK,CAAC;QAErB,gBAAU,GAAG,IAAI,CAAC;QAElB,WAAK,GAAY,KAAK,CAAC;QAEvB,cAAQ,GAAG,IAAI,CAAC;QAEhB,UAAI,GAAY,KAAK,CAAC;QAEtB,WAAK,GAAG,IAAI,CAAC;;IAkIzB,CAAC;IAhIG,wBAAwB;IAExB,uBAAM,GAAN;QACI,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QACtD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QACtD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;QAC1D,IAAI,CAAC,UAAU,GAAG,IAAI,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAC5C,IAAI,CAAC,QAAQ,GAAG,IAAI,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,IAAI,YAAY,GAAG,CAAC,CAAC;QACrB,IAAI,UAAU,GAAG,CAAC,CAAC;QACnB,KAAI,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,YAAY,EAAE,CAAC,EAAE,EAAE;YAC1C,IAAI,MAAM,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAE/C,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;SAC/B;QACD,KAAI,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,UAAU,EAAE,CAAC,EAAE,EAAE;YACxC,IAAI,IAAI,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAE3C,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;SAC3B;IACL,CAAC;IAED,sBAAK,GAAL;IAEA,CAAC;IAED,uBAAM,GAAN,UAAQ,EAAE;QACN,IAAG,CAAC,IAAI,CAAC,GAAG,EAAE;YACV,IAAG,CAAC,IAAI,CAAC,KAAK,EAAE;gBACZ,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;gBACpB,IAAG,IAAI,CAAC,IAAI,EAAE;oBACV,IAAI,CAAC,UAAU,EAAE,CAAC;iBACrB;gBACD,IAAG,IAAI,CAAC,KAAK,EAAE;oBACX,IAAI,CAAC,YAAY,EAAE,CAAC;iBACvB;gBACD,IAAG,IAAI,CAAC,IAAI,EAAE;oBACV,IAAI,CAAC,UAAU,EAAE,CAAC;iBACrB;gBACD,IAAI,CAAC,eAAe,EAAE,CAAC;aAC1B;SACJ;IACL,CAAC;IAED,+BAAc,GAAd,UAAe,OAAO,EAAE,IAAI,EAAE,KAAK;QAC/B,IAAG,OAAO,CAAC,gBAAgB,EAAE,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,EAAE,EAAE,oBAAoB;YAC9D,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;SAC1B;QACD,gDAAgD;QAChD,8BAA8B;QAC9B,IAAI;IACR,CAAC;IAED,2BAAU,GAAV,UAAW,EAAE;QACT,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC,CAAI,iBAAiB;QAC7E,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QACvD,IAAG,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,IAAI,CAAC,eAAe,IAAI,CAAC,EAAE,EAAI,iCAAiC;YAC1F,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;YACrB,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;SAC9B;aAAM,IAAG,IAAI,CAAC,aAAa,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,eAAe,IAAI,CAAC,CAAC,EAAE;YAC9D,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACtB,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SAC/B;IACL,CAAC;IAED,2BAAU,GAAV;QACI,IAAG,IAAI,CAAC,UAAU,EAAE,EAAG,sBAAsB;YACzC,IAAI,CAAC,SAAS,CAAC,cAAc,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC,CAAI,uBAAuB;YACvF,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;YACxB,EAAE,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;SACpD;IACL,CAAC;IAEO,6BAAY,GAApB;QAEI,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,MAAM,GAAG,IAAI,CAAC;QAClB,IAAI,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,GAAG,CAAC;YAC1B,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAElD,IAAG,MAAM,IAAI,IAAI,EAAE;YACf,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACjD;IACL,CAAC;IAEO,2BAAU,GAAlB;QAEI,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;QAClB,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,GAAG,CAAC;YACxB,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAE5C,IAAG,IAAI,IAAI,IAAI,EAAE;YACb,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC/C,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC7C;IACL,CAAC;IAED,0BAAS,GAAT;QACI,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,kBAAkB,CAAC,CAAC,OAAO,GAAG,KAAK,CAAC;QAC9D,EAAE,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;IACpD,CAAC;IAED,gCAAe,GAAf;IAEA,CAAC;IAED,uCAAsB,GAAtB,UAAuB,GAAW;QAC9B,IAAI,CAAC,aAAa,GAAG,GAAG,CAAC;IAC7B,CAAC;IAED,yCAAwB,GAAxB,UAAyB,GAAW;QAChC,IAAI,CAAC,eAAe,GAAG,GAAG,CAAC;IAC/B,CAAC;IAED,8BAAa,GAAb,UAAc,GAAY;QACtB,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;IACpB,CAAC;IAED,+BAAc,GAAd;QACI,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;IACtB,CAAC;IAED,8BAAa,GAAb,UAAc,KAAK;QACf,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACrB,CAAC;IAhLD;QADC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC;6CACQ;IAG/B;QADC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC;4CACO;IAG9B;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;gDACmB;IAGvC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;8CACiB;IAZpB,MAAM;QAD1B,OAAO;OACa,MAAM,CAoL1B;IAAD,aAAC;CApLD,AAoLC,CApLmC,EAAE,CAAC,SAAS,GAoL/C;kBApLoB,MAAM","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Player extends cc.Component {\r\n\r\n    @property(cc.AudioClip)\r\n    jumpAudio: cc.AudioClip = null;\r\n\r\n    @property(cc.AudioClip)\r\n    dieAudio: cc.AudioClip = null;\r\n\r\n    @property(cc.Prefab)\r\n    private bulletPrefab: cc.Prefab = null;\r\n\r\n    @property(cc.Prefab)\r\n    private bombPrefab: cc.Prefab = null;\r\n\r\n    private playerName = null;\r\n\r\n    private moveSpeed: number = 300;\r\n\r\n    private moveDirection: number = 0;\r\n\r\n    private changeDirection: number = 0;\r\n\r\n    private jumpVelocity: number = 2500;\r\n\r\n    private jump: boolean = false;\r\n\r\n    private isOnGround: boolean = false;\r\n\r\n    private isDie: boolean = false;\r\n\r\n    private isMove: boolean = false;\r\n\r\n    private animation: cc.Animation = null;\r\n\r\n    private animationState = null;\r\n\r\n    private rigidBody: cc.RigidBody = null;\r\n\r\n    private isDieBound: boolean = false;\r\n\r\n    private win: boolean = false;\r\n\r\n    private bulletPool = null;\r\n\r\n    private shoot: boolean = false;\r\n\r\n    private bombPool = null;\r\n\r\n    private bomb: boolean = false;\r\n\r\n    private angle = null;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.animation = this.node.getComponent(cc.Animation);\r\n        this.rigidBody = this.node.getComponent(cc.RigidBody);\r\n        this.playerName = this.node.getChildByName(\"Player Name\");\r\n        this.bulletPool = new cc.NodePool('Bullet');\r\n        this.bombPool = new cc.NodePool('Bomb');\r\n        let maxBulletNum = 5;\r\n        let maxBombNum = 5;\r\n        for(let i: number = 0; i < maxBulletNum; i++) {\r\n            let bullet = cc.instantiate(this.bulletPrefab);\r\n\r\n            this.bulletPool.put(bullet);\r\n        }\r\n        for(let i: number = 0; i < maxBombNum; i++) {\r\n            let bomb = cc.instantiate(this.bombPrefab);\r\n\r\n            this.bombPool.put(bomb);\r\n        }\r\n    }\r\n\r\n    start () {\r\n\r\n    }\r\n\r\n    update (dt) {\r\n        if(!this.win) {\r\n            if(!this.isDie) {\r\n                this.playerMove(dt);\r\n                if(this.jump) {\r\n                    this.playerJump();\r\n                }\r\n                if(this.shoot) {\r\n                    this.createBullet();\r\n                }\r\n                if(this.bomb) {\r\n                    this.createBomb();\r\n                }\r\n                this.playerAnimation();\r\n            }\r\n        }\r\n    }\r\n\r\n    onBeginContact(contact, self, other) {\r\n        if(contact.getWorldManifold().normal.y < 0) { // step on something\r\n            this.isOnGround = true;\r\n        }\r\n        // if(other.tag == 1){     // on ground or props\r\n        //     this.isOnGround = true;\r\n        // }\r\n    }\r\n\r\n    playerMove(dt) {\r\n        this.node.x += this.moveSpeed * this.moveDirection * dt;    // player walking\r\n        this.isMove = (this.moveDirection != 0) ? true : false;\r\n        if(this.moveDirection == 1 || this.changeDirection == 1) {   // change direction using scaling\r\n            this.node.scaleX = 1;\r\n            this.playerName.scaleX = 1;\r\n        } else if(this.moveDirection == -1 || this.changeDirection == -1) {\r\n            this.node.scaleX = -1;\r\n            this.playerName.scaleX = -1;\r\n        }\r\n    }\r\n\r\n    playerJump() {\r\n        if(this.isOnGround) {  // player is on ground\r\n            this.rigidBody.linearVelocity = cc.v2(0, this.jumpVelocity);    // add jumping velocity\r\n            this.isOnGround = false;\r\n            cc.audioEngine.playEffect(this.jumpAudio, false);\r\n        }\r\n    }\r\n\r\n    private createBullet()\r\n    {\r\n        this.shoot = false;\r\n        let bullet = null;\r\n        if (this.bulletPool.size() > 0) \r\n            bullet = this.bulletPool.get(this.bulletPool);\r\n\r\n        if(bullet != null) {\r\n            bullet.getComponent('Bullet').init(this.node);\r\n        }\r\n    }\r\n\r\n    private createBomb()\r\n    {\r\n        this.bomb = false;\r\n        let bomb = null;\r\n        if (this.bombPool.size() > 0) \r\n            bomb = this.bombPool.get(this.bombPool);\r\n\r\n        if(bomb != null) {\r\n            bomb.getComponent('Bomb').setAngle(this.angle);\r\n            bomb.getComponent('Bomb').init(this.node);\r\n        }\r\n    }\r\n\r\n    playerDie() {\r\n        this.isDie = true;\r\n        this.node.getComponent(cc.PhysicsBoxCollider).enabled = false;\r\n        cc.audioEngine.playEffect(this.dieAudio, false);\r\n    }\r\n\r\n    playerAnimation() {\r\n\r\n    }\r\n\r\n    setPlayerMoveDirection(dir: number) {\r\n        this.moveDirection = dir;\r\n    }\r\n\r\n    setPlayerChangeDirection(dir: number) {\r\n        this.changeDirection = dir;\r\n    }\r\n\r\n    setPlayerJump(val: boolean) {\r\n        this.jump = val;\r\n    }\r\n\r\n    setPlayerShoot() {\r\n        this.shoot = true;\r\n    }\r\n\r\n    setPlayerBomb(angle) {\r\n        this.angle = angle;\r\n        this.bomb = true;\r\n    }\r\n}\r\n"]}